"use strict";function endMove(){$(this).removeClass("movable")}function startMove(inicioX,inicioY,obj){var leftInicio=obj.css("left"),topInicio=obj.css("top");$(".movable").on("mousemove",function(e){var difX=e.clientX-inicioX,difY=e.clientY-inicioY;$(".movable").css({left:parseInt(leftInicio)+difX+"px",top:parseInt(topInicio)+difY+"px"})})}$(function(){$("#loading").fadeOut(1e3),$("body").on("keydown",function(e){if(27==e.keyCode)$(".dialogo").remove(),$("#pantallaBlanca").fadeOut(200),$("#pantallaBlancaError").fadeOut(200),ERMaker.estadoAplicacion==ESTADO_APLICACION.Anadiendo&&ERMaker.objetoActual.borrar(),ERMaker.estadoAplicacion=ESTADO_APLICACION.Normal,$("#btEditar").removeClass("botonSeleccionado"),$("#btBorrar").removeClass("botonSeleccionado");else if(65==e.keyCode){console.log("-----------------Lista de Objetos------------");var _iteratorNormalCompletion=!0,_didIteratorError=!1,_iteratorError=void 0;try{for(var _step,_iterator=ERMaker.listaObjetos[Symbol.iterator]();!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=!0){var obj=_step.value;console.log(obj.nombre)}}catch(err){_didIteratorError=!0,_iteratorError=err}finally{try{!_iteratorNormalCompletion&&_iterator["return"]&&_iterator["return"]()}finally{if(_didIteratorError)throw _iteratorError}}}}),$(document.body).on("mousedown",".dialogo",function(e){$(this).addClass("movable"),startMove(e.clientX,e.clientY,$(this))}).on("mouseup",".dialogo",function(){$(this).removeClass("movable"),endMove()}),$("#lienzo").on("mousemove",function(e){if(ERMaker.estadoAplicacion==ESTADO_APLICACION.Anadiendo){var scrollTop=$("#contenedor").scrollTop(),scrollLeft=$("#contenedor").scrollLeft();if(ERMaker.objetoActual.mover(e.clientX-Ajustes.w_barra_herramientas+scrollLeft,e.clientY-Ajustes.w_barra_superior+scrollTop),ERMaker.objetoActual.listaAtributos){var _iteratorNormalCompletion2=!0,_didIteratorError2=!1,_iteratorError2=void 0;try{for(var _step2,_iterator2=ERMaker.objetoActual.listaAtributos[Symbol.iterator]();!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=!0){var atributo=_step2.value;atributo.mover(e.clientX-Ajustes.w_barra_herramientas+scrollLeft,e.clientY-Ajustes.w_barra_superior+scrollTop)}}catch(err){_didIteratorError2=!0,_iteratorError2=err}finally{try{!_iteratorNormalCompletion2&&_iterator2["return"]&&_iterator2["return"]()}finally{if(_didIteratorError2)throw _iteratorError2}}}}}).on("click",function(e){if(ERMaker.estadoAplicacion==ESTADO_APLICACION.Anadiendo){if(ERMaker.estadoAplicacion=ESTADO_APLICACION.Normal,ERMaker.objetoActual.tipo!=TIPO_ER.ISA&&ERMaker.objetoActual.conjunto.set.animate({opacity:1},500),ERMaker.objetoActual.listaAtributos){var _iteratorNormalCompletion3=!0,_didIteratorError3=!1,_iteratorError3=void 0;try{for(var _step3,_iterator3=ERMaker.objetoActual.listaAtributos[Symbol.iterator]();!(_iteratorNormalCompletion3=(_step3=_iterator3.next()).done);_iteratorNormalCompletion3=!0){var atributo=_step3.value;atributo.conjunto.set.animate({opacity:1},500)}}catch(err){_didIteratorError3=!0,_iteratorError3=err}finally{try{!_iteratorNormalCompletion3&&_iterator3["return"]&&_iterator3["return"]()}finally{if(_didIteratorError3)throw _iteratorError3}}}(ERMaker.objetoActual.tipo==TIPO_ER.Entidad||ERMaker.objetoActual.tipo==TIPO_ER.Relacion||ERMaker.objetoActual.tipo==TIPO_ER.ISA||ERMaker.objetoActual.tipo==TIPO_ER.Debil)&&ERMaker.listaObjetos.push(ERMaker.objetoActual)}}),$("#btNuevaEntidad").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(new DialogoNuevaEntidad,$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3))}),$("#btNuevaRelacion").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(ERMaker.obtenerListaEntidades().length<=1?Dialogo.mostrarError(ERROR.NoHayEntidad):(new DialogoNuevaRelacion,$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3)))}),$("#btNuevaDebil").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(0==ERMaker.obtenerListaEntidades().length?Dialogo.mostrarError(ERROR.NoHayEntidad):(new DialogoNuevaDebil,$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3)))}),$("#btNuevaISA").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(ERMaker.obtenerListaEntidades().length<=1?Dialogo.mostrarError(ERROR.NoHaySuficientesEntidades):(new DialogoNuevaISA,$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3)))}),$("#btNuevoAtributo").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(ERMaker.obtenerListaEntidades().length<1?Dialogo.mostrarError(ERROR.NoHayEntidad):(new DialogoNuevoAtributo,$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3)))}),$("#btBorrar").on("click",function(e){switch(ERMaker.estadoAplicacion){case ESTADO_APLICACION.Anadiendo:ERMaker.objetoActual.borrar(),ERMaker.estadoAplicacion=ESTADO_APLICACION.Normal;break;case ESTADO_APLICACION.Borrando:$(this).removeClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Normal;break;case ESTADO_APLICACION.Normal:$(this).addClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Borrando;break;case ESTADO_APLICACION.Editando:$(this).addClass("botonSeleccionado"),$("#btEditar").removeClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Borrando}}),$("#btEditar").on("click",function(e){switch(ERMaker.estadoAplicacion){case ESTADO_APLICACION.Editando:$(this).removeClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Normal;break;case ESTADO_APLICACION.Normal:$(this).addClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Editando;break;case ESTADO_APLICACION.Borrando:$(this).addClass("botonSeleccionado"),$("#btBorrar").removeClass("botonSeleccionado"),ERMaker.estadoAplicacion=ESTADO_APLICACION.Editando}}),$("#btGuardar").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(new DialogoGuardarArchivo("Guardar archivo","Ruta y nombre"),$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3))}),$("#btCargar").on("click",function(e){ERMaker.estadoAplicacion==ESTADO_APLICACION.Normal&&(new DialogoCargarArchivo("Cargar archivo","Archivo"),$("#pantallaBlanca").fadeIn(1e3),$(".dialogo").fadeIn(1e3))})});